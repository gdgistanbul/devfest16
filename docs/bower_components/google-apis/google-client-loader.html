<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="google-js-api.html">



<script>!function(){"use strict";var e=!1,i={},t={};Polymer({is:"google-client-loader",properties:{name:String,version:String,appId:String,apiRoot:String,successEventName:{type:String,value:"google-api-load"},errorEventName:{type:String,value:"google-api-load-error"}},hostAttributes:{hidden:!0},_waiting:!1,get api(){return window.gapi&&window.gapi.client&&window.gapi.client[this.name]?window.gapi.client[this.name]:void 0},get auth(){return gapi.auth},ready:function(){this._loader=document.createElement("google-js-api"),this.listen(this._loader,"js-api-load","_loadClient")},detached:function(){this.unlisten(this._loader,"js-api-load","_loadClient")},_loadClient:function(){gapi.load("client",this._doneLoadingClient.bind(this))},_handleLoadResponse:function(e){e&&e.error?(i[this.name]="error",this._fireError(e)):(i[this.name]="loaded",this._fireSuccess())},_fireSuccess:function(){this.fire(this.successEventName,{name:this.name,version:this.version})},_fireError:function(e){e&&e.error?this.fire(this.errorEventName,{name:this.name,version:this.version,error:e.error}):this.fire(this.errorEventName,{name:this.name,version:this.version})},_doneLoadingClient:function(){e=!0,this._waiting||this._loadApi()},_createSelfRemovingListener:function(e){var i=function(){t[this.name].removeEventListener(e,i),this._loadApi()}.bind(this);return i},_loadApi:function(){if(e&&this.name&&this.version)if(this._waiting=!1,"loaded"==i[this.name])this._fireSuccess();else if("loading"==i[this.name])this._waiting=!0,t[this.name].addEventListener(this.successEventName,this._createSelfRemovingListener(this.successEventName)),t[this.name].addEventListener(this.errorEventName,this._createSelfRemovingListener(this.errorEventName));else if("error"==i[this.name])this._fireError(null);else{var n;this.apiRoot?n=this.apiRoot:this.appId&&(n="https://"+this.appId+".appspot.com/_ah/api"),i[this.name]="loading",t[this.name]=this,gapi.client.load(this.name,this.version,this._handleLoadResponse.bind(this),n)}}})}();</script>
</head><body></body></html>