window.HOVERBOARD=window.HOVERBOARD||{},HOVERBOARD.Analytics=HOVERBOARD.Analytics||function(t){"use strict";function e(){this.setTrackerDefaults(),this.initTrackerReadyState(),this.trackPageView(),this.trackPerfEvent("HTMLImportsLoaded","Polymer"),this.trackPerfEvent("WebComponentsReady","Polymer"),this.trackOnlineStatus(),this.trackServiceWorkerControlled();var e=t.location.search.match(/utm_error=([^&]+)/);e&&this.trackError("notification",decodeURIComponent(e[1])),this.startTimes_={}}return e.prototype.POLYMER_ANALYTICS_TIMEOUT_=6e4,e.prototype.FP_TIMEOUT_=6e3,e.prototype.READY_STATE_TIMEOUT_=5e3,e.prototype.NULL_DIMENSION="(not set)",e.prototype.customDimensions={SIGNED_IN:"dimension1",ONLINE:"dimension2",SERVICE_WORKER_STATUS:"dimension3",NOTIFICATION_PERMISSION:"dimension4",METRIC_VALUE:"dimension5"},e.prototype.requiredDimensions=[e.prototype.customDimensions.SIGNED_IN,e.prototype.customDimensions.ONLINE,e.prototype.customDimensions.SERVICE_WORKER_STATUS,e.prototype.customDimensions.NOTIFICATION_PERMISSION],e.prototype.setTrackerDefaults=function(){Object.keys(this.customDimensions).forEach(function(t){ga("set",this.customDimensions[t],this.NULL_DIMENSION)}.bind(this))},e.prototype.initTrackerReadyState=function(){this.readyState_=HOVERBOARD.Deferred.createDeferred(),setTimeout(function(){this.readyState_.resolve(),this.trackEvent("analytics","timeout",this.READY_STATE_TIMEOUT_,window.performance&&Math.round(window.performance.now()))}.bind(this),this.READY_STATE_TIMEOUT_)},e.prototype.updateTracker=function(t,e){ga(function(i){ga("set",t,e);var r=Object.keys(this.requiredDimensions),n=r.every(function(t){i.get(this.requiredDimensions[t])!==this.NULL_DIMENSION}.bind(this));n&&this.readyState_.resolve()})},e.prototype.waitForTrackerReady=function(){return this.readyState_.promise},e.prototype.trackPageView=function(t,e){this.waitForTrackerReady().then(function(){t&&ga("set","page",t),ga("send","pageview",{hitCallback:e})})},e.prototype.trackPerf=function(t,e,i,r,n,o){this.waitForTrackerReady().then(function(){null!==n&&i>n&&(e+=" - outliers"),i=parseInt(i,10),r=r||this.NULL_DIMENSION,o=o||{},o[this.customDimensions.METRIC_VALUE]=i,ga("send","event",t,e,r,i,o),ga("send","timing",t,e,i,r,o)})},e.prototype.trackEvent=function(t,e,i,r,n){this.waitForTrackerReady().then(function(){ga("send",{hitType:"event",eventCategory:t,eventAction:e,eventLabel:i||this.NULL_DIMENSION,eventValue:r,hitCallback:n})}.bind(this))},e.prototype.trackError=function(t,e){this.waitForTrackerReady().then(function(){ga("send","event","error",t,String(e))})},e.prototype.trackSocial=function(t,e,i){this.waitForTrackerReady().then(function(){ga("send","social",t,e,i)})},e.prototype.trackPerfEvent=function(e,i){if(t.performance&&t.performance.getEntriesByName){var r=performance.getEntriesByName(e,"mark");if(r.length){var n=r[0].startTime;debugLog(e,"@",n),this.trackPerf(i,e,n,null,this.POLYMER_ANALYTICS_TIMEOUT_)}else document.addEventListener(e,this.trackPerfEvent.bind(this,e,i))}},e.prototype.timeStart=function(t,e,i){var r=this.startTimes_[t]||(this.startTimes_[t]={});r[e]=i},e.prototype.timeEnd=function(t,e,i,r,n){var o=this.startTimes_[t];if(o){var s=o[e];null!==s&&(this.trackPerf(t,e,i-s,r,n),o[e]=null)}},e.prototype.trackOnlineStatus=function(){this.updateTracker(this.customDimensions.ONLINE,navigator.onLine);var t=function(t){this.updateTracker(this.customDimensions.ONLINE,navigator.onLine),this.trackEvent("network","change",t.type)}.bind(this);window.addEventListener("online",t),window.addEventListener("offline",t)},e.prototype.trackServiceWorkerControlled=function(){var t=this.getServiceWorkerStatus();this.updateTracker(this.customDimensions.SERVICE_WORKER_STATUS,t),"unsupported"===t?this.trackEvent("serviceworker","supported",!1):(this.trackEvent("serviceworker","supported",!0),this.trackEvent("serviceworker","controlled","controlled"===t))},e.prototype.getServiceWorkerStatus=function(){return"serviceWorker"in navigator?navigator.serviceWorker.controller?"controlled":"supported":"unsupported"},e.prototype.getNotificationPermission=function(){return t.Notification?t.Notification.permission:"unsupported"},new e}(window);