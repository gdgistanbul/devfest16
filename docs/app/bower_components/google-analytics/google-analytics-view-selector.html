<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="account-summaries-import.html">
<link rel="import" href="google-analytics-loader.html">



</head><body><dom-module id="google-analytics-view-selector">

  <style>:host{display:inline-block;}.control{@apply (--google-analytics-view-selector-control);}label{@apply (--google-analytics-view-selector-label);}select{color:inherit;font:inherit;margin:0;@apply (--google-analytics-view-selector-select);}select:focus{@apply (--google-analytics-view-selector-select-focus);}</style>

  <template>
    <google-analytics-loader all-ready="{{setupReady}}"></google-analytics-loader>
    <span class="control">
      <label for="account">Account</label>
      <select id="account" on-change="updateAccount" value="{{account.id}}">
        <template is="dom-repeat" items="{{accounts}}">
          <option value="{{item.id}}">{{item.name}}</option>
        </template>
      </select>
    </span>
    <span class="control">
      <label>Property</label>
      <select id="property" on-change="updateProperty" value="{{property.id}}">
        <template is="dom-repeat" items="{{account.properties}}">
          <option value="{{item.id}}">{{item.name}}</option>
        </template>
      </select>
    </span>
    <span class="control">
      <label>View</label>
      <select id="view" on-change="updateView" value="{{view.id}}">
        <template is="dom-repeat" items="{{property.views}}">
          <option value="{{item.id}}">{{item.name}}</option>
        </template>
      </select>
    </span>
  </template>

</dom-module>

<script>!function(){"use strict";Polymer({is:"google-analytics-view-selector",properties:{ids:{type:String,observer:"idsChanged",notify:!0},summaries:{type:Object,value:null},account:{type:Object,observer:"accountChanged"},property:{type:Object,observer:"propertyChanged"},view:{type:Object,observer:"viewChanged"},setupReady:{type:Boolean,observer:"setupReadyChanged"}},setupReadyChanged:function(t,e){t?gaApiUtils.accountSummaries.get().then(function(t){this.summaries=t,this.accounts=t.all(),this.ids?this.idsChanged(null,this.ids):this.account=this.accounts[0]}.bind(this)):(this.summaries=null,this.accounts=null,this.account=null,this.property=null,this.view=null,this.ids=null)},updateAccount:function(){this.account=this.summaries.getAccount(this.$.account.value)},updateProperty:function(){this.property=this.summaries.getProperty(this.$.property.value)},updateView:function(){this.view=this.summaries.getView(this.$.view.value)},accountChanged:function(t,e){t&&(this.property=t.properties[0])},propertyChanged:function(t,e){t&&(this.view=t.views[0])},viewChanged:function(t,e){this.ids=t&&"ga:"+t.id},idsChanged:function(t,e){if(this.summaries){var i=t&&t.slice(3),s=this.summaries.getAccountByViewId(i),n=this.summaries.getPropertyByViewId(i),a=this.summaries.getView(i);s&&n&&a?(this.account=s,this.property=n,this.view=a,this.fireChangeEvent()):e||(this.account=this.summaries.all()[0])}},fireChangeEvent:function(){this.fire("analytics-dashboard-control-change",{ids:this.ids,account:this.account,property:this.property,view:this.view})}})}();</script>
</body></html>