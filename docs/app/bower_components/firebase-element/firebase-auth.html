<html><head><link rel="import" href="firebase.html">
<link rel="import" href="../polymer/polymer.html">



<script>Polymer({is:"firebase-auth",properties:{location:{type:String,reflectToAttribute:!0,observer:"_locationChanged"},provider:{type:String,reflectToAttribute:!0,value:"anonymous"},user:{type:Object,readOnly:!0,notify:!0},autoLogin:{type:Boolean,value:!1,reflectToAttribute:!0},statusKnown:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},redirect:{type:Boolean,value:!1,reflectToAttribute:!0},params:{type:Object},options:{type:Object},ref:{type:Object,readOnly:!0,notify:!0},_boundAuthHandler:{value:function(){return this._authHandler.bind(this)}},_boundOnlineHandler:{value:function(){return this._onlineHandler.bind(this)}},_queuedLogin:{type:Object}},attached:function(){window.addEventListener("online",this._boundOnlineHandler)},detached:function(){window.removeEventListener("online",this._boundOnlineHandler),this.ref.offAuth(this._boundAuthHandler)},_locationChanged:function(e){this.debounce("locationChanged",function(){this.ref&&this.ref.offAuth(this._boundAuthHandler),e?(this._setRef(new Firebase(e)),this.ref.onAuth(this._boundAuthHandler)):this._setRef(null)},1)},_loginHandler:function(e,t){e&&this.fire("error",e)},_authHandler:function(e){e?(this._setUser(e),this._setStatusKnown(!0),this.fire("login",{user:e})):(this._setUser(null),this.statusKnown&&(this._setStatusKnown(!1),this.fire("logout")),this._queuedLogin?(this.login(this._queuedLogin.params,this._queuedLogin.options),this._queuedLogin=null):!this.statusKnown&&this.autoLogin&&this.login(),this._setStatusKnown(!0))},login:function(e,t){if(this.ref&&navigator.onLine!==!1)switch(e=e||this.params||void 0,t=t||this.options||void 0,this.provider){case"password":this.ref.authWithPassword(e,this._loginHandler.bind(this),t);break;case"anonymous":this.ref.authAnonymously(this._loginHandler.bind(this),e);break;case"custom":this.ref.authWithCustomToken(e.token,this._loginHandler.bind(this));break;case"facebook":case"google":case"github":case"twitter":e&&e.token?this.ref.authWithOAuthToken(this.provider,e.token,this._loginHandler.bind(this),e):this.redirect?this.ref.authWithOAuthRedirect(this.provider,this._loginHandler.bind(this),e):this.ref.authWithOAuthPopup(this.provider,this._loginHandler.bind(this),e);break;default:throw"Unknown provider: "+this.provider}else this._queuedLogin={params:e,options:t}},logout:function(){navigator.onLine===!1?this.queuedLogout=!0:this.ref.unauth()},_onlineHandler:function(){this.queuedLogout?(this.queuedLogout=!1,this.logout()):this.queuedLogin&&(this.login(this.queuedLogin.params,this.queuedLogin.options),this.queuedLogin=null)},createUser:function(e,t){this.ref.createUser({email:e,password:t},function(e,t){e?this.fire("error",e):this.fire("user-created",{user:t})}.bind(this))},changePassword:function(e,t,i){this.ref.changePassword({email:e,oldPassword:t,newPassword:i},function(e){e?this.fire("error",e):this.fire("password-changed")}.bind(this))},sendPasswordResetEmail:function(e){this.ref.resetPassword({email:e},function(e){e?this.fire("error",e):this.fire("password-reset")}.bind(this))},changeEmail:function(e,t,i){this.ref.changeEmail({oldEmail:e,newEmail:t,password:i},function(e){e?this.fire("error",e):this.fire("email-changed")}.bind(this))},removeUser:function(e,t){this.ref.removeUser({email:e,password:t},function(e,t){e?this.fire("error",e):this.fire("user-removed")}.bind(this))}});</script>
</head><body></body></html>